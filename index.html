<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width,initial-scale=1,user-scalable=yes">
  <title>í•™ìƒ ìƒí™œì§€ë„ ì•±</title>
  <style>
    /* ì „ì²´ ê½‰ ì±„ìš°ê³ , ìŠ¤í¬ë¡¤ì€ container ì—ë§Œ */
    html, body { height:100%;margin:0;overflow:hidden; }
    #container {
      position:fixed;inset:0;
      overflow-y:auto;-webkit-overflow-scrolling:touch;
      background:#eaf6ff;
      display:flex;flex-direction:column;align-items:center;
      box-sizing:border-box;padding:1vh 0;
    }
    /* íƒ­ */
    .tabs { display:flex;width:100%; }
    .tab-btn {
      flex:1;padding:1.5vh 0;
      font-size:4vw;
      border:none;background:#fff;color:#444;
      cursor:pointer;
    }
    .tab-btn.active { background:#4eaaff;color:#fff; }
    /* íŒ¨ë„ */
    .tab-panel { display:none;width:100%; }
    .tab-panel.active { display:block; }
    /* ì¹´ë“œ(í¼) */
    .card {
      background:#fff;
      width:96vw;
      margin:2vh 0;
      padding:2vh 4vw;
      border-radius:2vh;
      box-shadow:0 2px 12px rgba(0,0,0,0.1);
      box-sizing:border-box;
    }
    .form-group { margin-bottom:2vh; }
    label {
      display:block;margin-bottom:1vh;
      font-size:3.5vw;color:#4e7cbf;
    }
    input, select {
      width:100%;
      padding:2vh 3vw;
      font-size:4vw;
      border:1px solid #ccd8e8;
      border-radius:1.5vh;
      box-sizing:border-box;
    }
    .submit {
      width:100%;
      padding:2.5vh 0;
      margin-top:1vh;
      font-size:4.5vw;
      color:#fff;
      background:#4eaaff;
      border:none;
      border-radius:2vh;
      cursor:pointer;
    }
    .result-card {
      background:#f0f8ff;
      padding:2vh 3vw;
      margin-top:1vh;
      border-radius:1.5vh;
      font-size:3.8vw;
      box-sizing:border-box;
    }
    /* í—¤ë” */
    .header {
      width:100%;padding:2vh 0;text-align:center;
    }
    .header h2 {
      margin:0;font-size:6vw;color:#4eaaff;
      font-weight:800;
    }
  </style>
</head>
<body>
  <div id="container">
    <!-- í—¤ë” -->
    <div class="header">
      <h2>í•™ìƒ ìƒí™œì§€ë„ ì•±</h2>
    </div>
    <!-- íƒ­ -->
    <div class="tabs">
      <button id="btnInput" class="tab-btn active"
              onclick="showTab('input')">ì…ë ¥</button>
      <button id="btnView"  class="tab-btn"
              onclick="showTab('view')">ì¡°íšŒ</button>
    </div>

    <!-- ì…ë ¥ íƒ­ -->
    <div id="input" class="tab-panel active">
      <div class="card">
        <div class="form-group">
          <label for="date">ë‚ ì§œ</label>
          <input id="date" type="date">
        </div>
        <div class="form-group">
          <label for="period">êµì‹œ</label>
          <input id="period" placeholder="êµì‹œ">
        </div>
        <div class="form-group">
          <label for="stuId">í•™ë²ˆ</label>
          <input id="stuId" placeholder="í•™ë²ˆ">
        </div>
        <div class="form-group">
          <label for="name">ì´ë¦„</label>
          <input id="name" placeholder="ì´ë¦„">
        </div>
        <div class="form-group">
          <label for="status">ìƒíƒœ</label>
          <select id="status">
            <option>ìˆ˜ì—… ë°©í•´</option>
            <option>ìˆ˜ì—…ì¤‘ í™”ì¥ì‹¤</option>
            <option>ë³´ê±´ì‹¤</option>
            <option>êµë³µ ë¯¸ì°©ìš©</option>
          </select>
        </div>
        <button class="submit" onclick="saveData()">ì €ì¥</button>
      </div>
    </div>

    <!-- ì¡°íšŒ íƒ­ -->
    <div id="view" class="tab-panel">
      <div class="card">
        <div class="form-group">
          <label for="queryId">í•™ë²ˆ</label>
          <input id="queryId" placeholder="ì¡°íšŒí•  í•™ë²ˆ">
        </div>
        <div class="form-group">
          <label for="queryDate">ë‚ ì§œ</label>
          <input id="queryDate" type="date">
        </div>
        <button class="submit" onclick="queryData()">ì¡°íšŒ</button>
        <div id="result"></div>
      </div>
    </div>
  </div>

  <script>
    function showTab(id) {
      document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
      document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
      document.getElementById('btn'+capitalize(id)).classList.add('active');
      document.getElementById(id).classList.add('active');
      if(id==='view') {
        document.getElementById('result').innerHTML='';
        document.getElementById('queryId').value='';
        document.getElementById('queryDate').value='';
      }
    }
    function saveData() {
      google.script.run.withSuccessHandler(()=>{
        alert('âœ… ì €ì¥ ì™„ë£Œ!');
        ['date','period','stuId','name'].forEach(id=>document.getElementById(id).value='');
        document.getElementById('status').selectedIndex=0;
      }).save({
        date:   document.getElementById('date').value,
        period: document.getElementById('period').value,
        stuId:  document.getElementById('stuId').value,
        name:   document.getElementById('name').value,
        status: document.getElementById('status').value
      });
    }
    function queryData() {
      var id=document.getElementById('queryId').value.trim(),
          dt=document.getElementById('queryDate').value;
      if(!id||!dt){ return alert('í•™ë²ˆê³¼ ë‚ ì§œë¥¼ ì…ë ¥í•˜ì„¸ìš”'); }
      google.script.run.withSuccessHandler(function(data){
        var html = data.length
          ? data.map(function(d){
              return '<div class="result-card">['+
                     d.date+' '+d.period+'êµì‹œ] '+
                     d.name+' â€“ '+d.status+
                     '</div>';
            }).join('')
          : '<div class="result-card">ğŸ“­ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
        document.getElementById('result').innerHTML = html;
      }).queryByDate(id,dt);
    }
    function capitalize(s){return s[0].toUpperCase()+s.slice(1);}
  </script>
</body>
</html>
